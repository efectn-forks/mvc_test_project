@using mvc_proje.Application.Dtos.Admin.Category
@using mvc_proje.Domain.Entities
@{
  Layout = "_AdminLayout";
}

@model mvc_proje.Application.Dtos.Admin.Product.ProductEditDto

@await Html.PartialAsync("_Editor")

<!--end::App Content Header-->
<!--begin::App Content-->
<div class="app-content">
  <!--begin::Container-->
  <div class="container-fluid">
    <!--begin::Row-->
    <div class="row">
      <div class="col-md-12">
        <div class="card mb-8">
          <div class="card card-primary card-outline mb-4">
            <!--begin::Form-->
            <form method="post" asp-action="Update" asp-controller="Product" asp-antiforgery="true"
                  enctype="multipart/form-data">
              <input type="hidden" asp-for="Id" value="@Model.Id"/>
              <!--begin::Body-->
              <div class="card-body">
                <div class="mb-3">
                  <label for="name" class="form-label">İsim</label>
                  <input
                    type="text"
                    name="name"
                    class="form-control"
                    value="@Model.Name"
                    id="name"/>
                </div>

                <div class="mb-3">
                  <label for="SkuNumber" class="form-label">SKU Numarası</label>
                  <input
                    type="text"
                    name="SkuNumber"
                    class="form-control"
                    value="@Model.SkuNumber"
                    id="SkuNumber"/>
                </div>

                <div class="mb-3">
                  <label for="description" class="form-label">Açıklama</label>
                  <textarea class="form-control" name="description" id="description">@Model.Description</textarea>
                </div>
                
                <div class="mb-3">
                  <label for="summernote" class="form-label">İçerik</label>
                  <textarea class="form-control" asp-for="Content" id="summernote"></textarea>
                </div>

                <div class="row mb-3">
                  <div class="col-6">
                    <label for="price" class="form-label">Fiyat</label>
                    <input type="text" class="form-control" name="price" id="price" value="@Model.Price"/>
                  </div>
                  <div class="col-6">
                    <label for="stock" class="form-label">Stok</label>
                    <input type="text" class="form-control" name="stock" id="stock" value="@Model.Stock"/>
                  </div>
                </div>

                <div class="mb-3">
                  <label for="CategoryId" class="form-label">Kategori</label>
                  <select class="form-select" name="CategoryId" id="CategoryId" aria-label="Default select example">
                    @foreach (var category in (ViewData["categories"] as CategoryIndexDto).Categories)
                    {
                      var selected = Model.CategoryId == category.Id ? "selected" : "";


                      <option value="@category.Id" selected="@selected">@category.Name</option>
                    }
                  </select>
                </div>

                <div class="mb-3">
                  <label for="Image" class="form-label">Resim</label>
                  <input
                    type="file"
                    name="Image"
                    class="form-control"
                    id="Image"/>
                </div>

                @if (Model.ImageUrl != null)
                {
                  <div class="mb-3">
                    <img src="@Url.Content(Model.ImageUrl)" width="500" height="500" alt="Post Image"
                         class="img-fluid"/>
                  </div>
                }
              </div>
              <!--end::Body-->
              <!--begin::Footer-->
              <div class="card-footer">
                <button type="submit" class="btn btn-primary">Gönder</button>
              </div>
              <!--end::Footer-->
            </form>
            <!--end::Form-->
          </div>
        </div>
      </div>
    </div>

    <div class="row mt-3">
      <div class="col-md-12">
        <div class="card mb-8">
          <div class="card card-primary card-outline mb-4">
            <div class="card-header">
              <h3 class="card-title">Ürün Özellikleri</h3>
            </div>

            <div class="card-body">
              <table class="table table-bordered">
                <thead>
                <tr>
                  <th style="width: 10px">#</th>
                  <th>Anahtar</th>
                  <th>Değer</th>
                  <th style="width: 80px">İşlemler</th>
                </tr>
                </thead>
                <tbody>

                @foreach (var feature in Model.ProductFeatures)
                {
                  <tr class="align-middle">
                    <td>@feature.Id</td>
                    <td>@feature.Key</td>
                    <td>@feature.Value</td>
                    <td>
                      <p class="d-inline-flex gap-1">
                        <a type="submit" asp-controller="ProductFeature" asp-action="Delete" asp-route-id="@feature.Id"
                           class="btn btn-sm btn-danger">Sil</a>
                      </p>
                    </td>
                  </tr>
                }
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row mt-3">
      <div class="col-md-12">
        <div class="card mb-8">
          <div class="card card-primary card-outline mb-4">
            <div class="card-header">
              <h3 class="card-title">Ürün Özelliği Ekle</h3>
            </div>

            <div class="card-body">
              <form method="post" asp-action="Create" asp-controller="ProductFeature" asp-antiforgery="true">
                <input type="hidden" name="ProductId" value="@Model.Id"/>
                <!--begin::Body-->
                <div class="card-body">
                  <div class="mb-3">
                    <label for="Key" class="form-label">Anahtar</label>
                    <input
                      type="text"
                      name="Key"
                      class="form-control"
                      id="Key"/>
                  </div>

                  <div class="mb-3">
                    <label for="Value" class="form-label">Değer</label>
                    <input
                      type="text"
                      name="Value"
                      class="form-control"
                      id="Value"/>
                  </div>
                </div>
                <!--end::Body-->
                <!--begin::Footer-->
                <div class="card-footer">
                  <button type="submit" class="btn btn-primary">Gönder</button>
                </div>
                <!--end::Footer-->
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!--end::Row-->
  </div>
  <!--end::Container-->
</div>